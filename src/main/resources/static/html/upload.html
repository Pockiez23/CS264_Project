<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home | Petition System</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/html/css/upload.css">
</head>
<body>

    <!-- üî∏ Header -->
    <header class="navbar">
        <!-- ‡πÅ‡∏ñ‡∏ö‡∏ö‡∏ô: ‡πÇ‡∏•‡πÇ‡∏Å‡πâ + ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ -->
        <div class="top-bar">
            <div class="logo">
                <img src="/Photo/Sci_TU_Logo_TH-1.png" alt="TU Logo">
            </div>

            <div class="account" id="accountBtn">
                <img src="/Photo/broker-vector-icon.jpg" alt="User">
                <div class="account-info">
                    <span class="name"></span>
                    <span class="id"></span>
                </div>
            </div>

            <!-- Popup -->
            <div class="popup" id="popup">
                <p><span id="popupName"></span><br><small id="popupID"></small></p>
                <button id="logoutBtn">LOGOUT</button>
            </div>
        </div>

        <!-- ‡πÅ‡∏ñ‡∏ö‡∏•‡πà‡∏≤‡∏á: ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å -->
        <nav class="menu-bar">
            <a href="#">‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô</a>
            <a href="#">‡∏ù‡πà‡∏≤‡∏¢‡∏Ñ‡∏ì‡∏∞‡∏ö‡∏î‡∏µ</a>
            <a href="#">‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ù‡πà‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏Ñ‡∏õ‡∏Å‡∏ï‡∏¥</a>
            <a href="#">‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ù‡πà‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏Ñ‡∏û‡∏¥‡πÄ‡∏®‡∏©</a>
            <a href="#">‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏ì‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏Ø</a>
            <a href="form-list.html">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á</a>
            <a href="upload.html">‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á</a>
        </nav>
    </header>


    <!-- üî∏ Main Content -->
    <main>
        <a href="home.html" class="back-btn">‚Üê Back to Home</a>
        <div class="upload-box" id="uploadBox">
            <label for="fileUpload">
                <img src="/Photo/file-upload-export-icon.png" alt="Upload Icon">
                <p>Upload File PDF, PNG, JPG</p>
            </label>
            <input type="file" id="fileUpload" accept=".pdf,.png,.jpg,.jpeg" hidden>
        </div>
        <button id="uploadBtn" class="upload-btn">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå</button>    
    </main>


    <!-- üî∏ Footer -->
    <footer>
        <p>‡∏Ñ‡∏ì‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ ‡∏°‡∏ò. ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏£‡∏±‡∏á‡∏™‡∏¥‡∏ï ‡∏ä‡∏±‡πâ‡∏ô 3 ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏£‡∏ß‡∏° 5<br>
        ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà 99 ‡∏´‡∏°‡∏π‡πà 18 ‡∏ñ‡∏ô‡∏ô‡∏û‡∏´‡∏•‡πÇ‡∏¢‡∏ò‡∏¥‡∏ô ‡∏ï.‡∏Ñ‡∏•‡∏≠‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á ‡∏≠.‡∏Ñ‡∏•‡∏≠‡∏á‡∏´‡∏•‡∏ß‡∏á ‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ 12120<br>
        ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå : 0-2564-4440-79 ‡∏ï‡πà‡∏≠ 2010</p>
        <p>Email: <a href="mailto:SCITECH.THAMMASAT@GMAIL.COM">scitech.thammasat@gmail.com</a> |
           Facebook: <a href="https://www.facebook.com/ScienceThammasat/" target="_blank" rel="noopener noreferrer">Science and Technology Thammasat Official</a></p>
    </footer>
    <script src="auth.js"></script>
    <script>
        // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô
        const session = requireAuth("login.html");

        // (‡∏≠‡∏≠‡∏õ‡∏ä‡∏±‡∏ô) ‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠-‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÉ‡∏ô‡∏´‡∏±‡∏ß‡πÄ‡∏ß‡πá‡∏ö
        document.addEventListener("DOMContentLoaded", () => {
            fillUserHeader(); // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏±‡∏ß‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤
        });
    </script>
    <script>
        const uploadBtn = document.getElementById("uploadBtn");
        const fileInput = document.getElementById("fileUpload");
        const uploadBox = document.getElementById("uploadBox");

        // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
        fileInput.addEventListener("change", function () {
            const file = this.files[0];
            if (!file) return;

            const validTypes = ["application/pdf", "image/png", "image/jpeg"];
            if (!validTypes.includes(file.type)) {
                alert("‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏ü‡∏•‡πå PDF, PNG, ‡∏´‡∏£‡∏∑‡∏≠ JPG ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô");
                fileInput.value = "";
                return;
            }

            // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏ô upload box
            uploadBox.innerHTML = "";

            // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏û ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏†‡∏≤‡∏û‡∏à‡∏£‡∏¥‡∏á
            if (file.type === "image/png" || file.type === "image/jpeg") {
                const img = document.createElement("img");
                img.src = URL.createObjectURL(file);
                img.alt = "Preview";
                img.classList.add("preview-image");
                uploadBox.appendChild(img);
            } else {
                // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô PDF ‚Üí ‡πÅ‡∏™‡∏î‡∏á icon PDF
                const pdfIcon = document.createElement("img");
                pdfIcon.src = "337946.png";
                pdfIcon.alt = "PDF Icon";
                pdfIcon.classList.add("preview-pdf");
                uploadBox.appendChild(pdfIcon);
            }

            const fileName = document.createElement("p");
            fileName.textContent = `‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: ${file.name}`;
            fileName.classList.add("file-name");
            uploadBox.appendChild(fileName);
        });

        // ‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î
        uploadBtn.addEventListener("click", function () {
            const file = fileInput.files[0];
            if (!file) {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î!");
                return;
            }       

            const validTypes = ["application/pdf", "image/png", "image/jpeg"];
            if (!validTypes.includes(file.type)) {
                alert("‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏ü‡∏•‡πå PDF, PNG, ‡∏´‡∏£‡∏∑‡∏≠ JPG ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô");
                return;
            }

            // ‚úÖ ‡πÄ‡∏Å‡πá‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå + URL preview
            const fileURL = URL.createObjectURL(file);
            localStorage.setItem("uploadedFileName", file.name);
            localStorage.setItem("uploadedFileURL", fileURL);

            window.location.href = "upload-edit.html";
        });
        
        uploadBox.addEventListener("click", function () {
            fileInput.click();
        });

        // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï popup ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• user
        document.addEventListener("DOMContentLoaded", () => {
        const session = getAuthSession();
        if (session) {
            const popupName = document.getElementById("popupName");
            const popupID = document.getElementById("popupID");
            if (popupName) popupName.textContent = session.name;
            if (popupID) popupID.textContent = session.student_id;
        }
        });

        // ‚úÖ Popup ‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î
        const accountBtn = document.getElementById("accountBtn");
        const popup = document.getElementById("popup");
        accountBtn.addEventListener("click", () => popup.classList.toggle("show"));
        document.addEventListener("click", e => {
            if (!accountBtn.contains(e.target) && !popup.contains(e.target)) popup.classList.remove("show");
        });

        // ‚úÖ Logout ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
        document.getElementById("logoutBtn").addEventListener("click", () => {
            if (confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) logout("login.html");
        });

    </script>
    

</body>
</html>
